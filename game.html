<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>åœ£ç‹ä¼ å¥‡ & æ¸¸æˆåŒºæœè¡¨</title>
  <!-- è½½å…¥ footer æ ·å¼ -->
<link rel="stylesheet" href="/footer.css" />
<!-- è½½å…¥ footer æ ·å¼ -->
  <style>
    :root{
      --bg:#0f1724; --card:#0b1220; --muted:#9aa4b2; --accent:#06b6d4;
      --radius:12px;
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family: Inter, Roboto, "Segoe UI", system-ui, -apple-system, "Helvetica Neue", Arial;
      background:linear-gradient(180deg,#071025 0%, #0b1a2a 100%);
      color:#e6eef8; min-height:100vh; padding:20px;
    }
    .wrap{max-width:1100px; margin:0 auto}
    header{text-align:center; margin-bottom:8px}
    header h1{font-size:20px; margin:6px 0}
    header p{margin:0; color:var(--muted); font-size:13px}

    /* é¡¶éƒ¨è¡Œï¼ˆæ¨¡å¼æŒ‰é’® + æ—¶é—´ï¼‰ */
    .top-row {
      display:flex; align-items:center; justify-content:space-between;
      gap:12px; flex-wrap:wrap; margin-bottom:12px;
    }
    .left-controls { display:flex; gap:8px; flex-wrap:wrap; align-items:center; }
    .right-info { color:var(--muted); font-size:14px; display:flex; gap:10px; align-items:center; }

    .mode-btn {
      background:rgba(255,255,255,0.08);
      color:#e6eef8;
      border:none;
      border-radius:999px;
      padding:7px 12px;
      cursor:pointer;
      font-weight:600;
      transition:background .12s ease, transform .08s ease;
    }
    .mode-btn:hover{background:rgba(255,255,255,0.12)}
    .mode-btn.active{background:linear-gradient(90deg,var(--accent),#7dd3fc); color:#022}

    /* é¡µç­¾ */
    .tabs { display:flex; gap:8px; justify-content:center; margin-bottom:12px; flex-wrap:wrap; }
    .tab-btn {
      background:transparent; color:var(--muted);
      border:1px solid rgba(255,255,255,0.04);
      padding:6px 12px; border-radius:8px; cursor:pointer; font-weight:600;
    }
    .tab-btn.active { background:linear-gradient(90deg,var(--accent),#7dd3fc); color:#022; border-color:transparent; }

    /* åœ£ç‹ä¼ å¥‡ å¡ç‰‡ç½‘æ ¼ */
    .grid{display:grid; grid-template-columns:repeat(auto-fit,minmax(200px,1fr)); gap:14px}
    .card{
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:var(--radius); padding:16px; cursor:pointer;
      transition:transform .12s ease, box-shadow .12s ease;
      box-shadow: 0 1px 0 rgba(255,255,255,0.02) inset, 0 6px 18px rgba(2,6,23,0.6);
      text-align:center;
    }
    .card:hover{box-shadow:0 8px 26px rgba(6,182,212,0.18)}
    .title{ font-weight:700; font-size:16px; color:#fff; margin-bottom:6px; }
    .badges{ display:flex; justify-content:center; align-items:center; flex-wrap:wrap; gap:6px; margin-bottom:6px; }
    .badge{ display:inline-flex; align-items:center; justify-content:center; font-size:12px; font-weight:700; border-radius:999px; padding:2px 8px; min-height:20px; line-height:1; white-space:nowrap; vertical-align:middle; box-shadow:0 1px 3px rgba(0,0,0,0.3); }
    .badge-new{background:#06b6d4; color:#022;}
    .badge-guild{background:#facc15; color:#222;}
    .badge-diamond{background:#38bdf8; color:#022;}
    .badge-merge{background:linear-gradient(90deg,#ef4444,#dc2626); color:#fff;}
    .info{font-size:13px; color:var(--muted)}

    /* æ¸¸æˆåˆ—è¡¨åŒºï¼ˆæ¥è‡ªä½ å‘çš„ä»£ç ï¼Œå«æ‚ ä¹…ä¼ å¥‡ç­‰ï¼‰ */
    .games-grid {
      display:grid;
      grid-template-columns:repeat(auto-fill,minmax(140px,1fr));
      gap:12px;
      margin-top:8px;
    }
    .game-card { background:#0b1220; padding:10px; border-radius:8px; text-align:center; }
    .game-card a { display:inline-block; padding:6px 8px; border-radius:6px; border:1px solid #225; color:#7dd3fc; text-decoration:none; margin:4px; font-weight:600; }
    .game-section-title { font-weight:700; margin:8px 0; color:#fff; text-align:center; }

    .footer-space { height:30px }

    /* responsive tweaks */
    @media (max-width:520px){
      .top-row{flex-direction:column; align-items:flex-start}
      .right-info{align-self:flex-end}
    }

    .toast{
      position:fixed; left:50%; transform:translateX(-50%);
      bottom:28px; background:linear-gradient(90deg,var(--accent),#7dd3fc);
      color:#022; padding:10px 16px; border-radius:999px;
      box-shadow:0 6px 24px rgba(6,22,34,0.6); font-weight:600;
      display:none; z-index:999;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>åœ£ç‹ä¼ å¥‡ & æ¸¸æˆåŒºæœå·¥å…·</h1>
      <p>ç‚¹å‡»æœåå¤åˆ¶æˆ–æ–°çª—å£æ‰“å¼€ï¼›å¯åˆ‡æ¢ç½‘ç«™å¹¶æŸ¥çœ‹å¯¹åº”å¼€æœè¡¨</p>
    </header>

    <div class="top-row">
      <div class="left-controls">
        <button id="copyMode" class="mode-btn active">ğŸ“‹ å¤åˆ¶é“¾æ¥</button>
        <button id="openMode" class="mode-btn">ğŸŒ æ–°çª—å£æ‰“å¼€</button>
        <button id="switchSite" class="mode-btn">ğŸ•¹ï¸ å½“å‰ç½‘ç«™ï¼š9awan</button>
        <button id="openServerList" class="mode-btn">ğŸ“… å¼€æœè¡¨</button>
        <button id="refreshBtn" class="mode-btn">ğŸ”„ åˆ·æ–°</button>
      </div>
      <div class="right-info">
        <div id="beijingTime">åŒ—äº¬æ—¶é—´åŠ è½½ä¸­...</div>
      </div>
    </div>

    <div class="tabs" role="tablist">
      <button class="tab-btn active" data-tab="swcq">åœ£ç‹ä¼ å¥‡</button>
      <button class="tab-btn" data-tab="games">æ¸¸æˆåˆ—è¡¨</button>
    </div>

    <!-- æ ‡ç­¾å†…å®¹ï¼šåœ£ç‹ä¼ å¥‡ -->
    <div id="tab-content-swcq">
      <div class="grid" id="cardContainer"></div>
    </div>

    <!-- æ ‡ç­¾å†…å®¹ï¼šæ¸¸æˆåˆ—è¡¨ï¼ˆåŒ…å« æ‚ ä¹…ä¼ å¥‡ ç­‰ï¼‰ -->
    <div id="tab-content-games" class="hidden">
      <div class="game-section-title">å…¶ä»–æ¸¸æˆ â€” åŒºæœå¿«é€Ÿå…¥å£</div>
      <div id="gamesArea" class="games-grid"></div>
    </div>

    <div class="footer-space"></div>
  </div>

  <div id="toast" class="toast">å·²å¤åˆ¶é“¾æ¥åˆ°å‰ªè´´æ¿</div>

  <script>
    // ================= åŒ—äº¬æ—¶é—´ =================
    function updateBeijingTime() {
      const now = new Date();
      // convert to Beijing by using toLocaleString with timezone
      const beijing = new Date(now.toLocaleString('en-US', { timeZone: 'Asia/Shanghai' }));
      const text = beijing.toLocaleString('zh-CN', { hour12: false });
      document.getElementById('beijingTime').textContent = 'åŒ—äº¬æ—¶é—´ï¼š' + text;
    }
    updateBeijingTime();
    setInterval(updateBeijingTime, 1000);

    // ================= ç½‘ç«™ / æ¨¡å¼ / æŒ‰é’® =================
    let currentDomain = "www.9awan.com";
    const siteBtn = document.getElementById("switchSite");
    const openServerListBtn = document.getElementById("openServerList");
    const copyBtn = document.getElementById("copyMode");
    const openBtn = document.getElementById("openMode");
    const refreshBtn = document.getElementById("refreshBtn");
    const toast = document.getElementById("toast");

    let currentMode = "copy"; // or "open"

    copyBtn.addEventListener('click', () => switchMode('copy'));
    openBtn.addEventListener('click', () => switchMode('open'));
    siteBtn.addEventListener('click', toggleSite);
    refreshBtn.addEventListener('click', () => { renderCards(); showToast('å·²åˆ·æ–°'); });

    function switchMode(mode){
      currentMode = mode;
      copyBtn.classList.toggle('active', mode === 'copy');
      openBtn.classList.toggle('active', mode === 'open');
    }

    function toggleSite(){
      if (currentDomain === 'www.9awan.com'){
        currentDomain = '88.3uyy.com';
        siteBtn.textContent = 'ğŸ•¹ï¸ å½“å‰ç½‘ç«™ï¼š3uyy';
      } else {
        currentDomain = 'www.9awan.com';
        siteBtn.textContent = 'ğŸ•¹ï¸ å½“å‰ç½‘ç«™ï¼š9awan';
      }
      renderCards();
      showToast('å·²åˆ‡æ¢åˆ° ' + currentDomain);
    }

    openServerListBtn.addEventListener('click', () => {
      const url = currentDomain.includes('9awan') ? 'http://www.9awan.com/home/server/283' : 'http://88.3uyy.com/home/server/283';
      window.open(url, '_blank');
    });

    function showToast(msg){
      toast.textContent = msg;
      toast.style.display = 'block';
      toast.style.opacity = '1';
      setTimeout(()=>{ toast.style.transition='opacity 300ms ease'; toast.style.opacity='0'; setTimeout(()=>toast.style.display='none',300); }, 1000);
    }

    // ================= åœ£ç‹ä¼ å¥‡ æ•°æ®ä¸æ¸²æŸ“ï¼ˆä¿ç•™ä½ ä¹‹å‰çš„å®ç°ï¼Œ2091~2116ï¼‰ =================
    const servers = [];
    const baseServerId = 98471;
    const baseServerNum = 2091;
    const baseDate = new Date("2025-10-06T00:00:00+08:00");

    function formatDateBeijingYYYYMMDD(ms) {
      return new Date(ms).toLocaleDateString("en-CA", { timeZone: "Asia/Shanghai" });
    }

    // 2091 ~ 2116 (26 ä¸ª)
    for (let i = 0; i <= 25; i++) {
      const serverNum = baseServerNum + i;
      const serverId = baseServerId + i;
      const ms = baseDate.getTime() + i * 24 * 60 * 60 * 1000;
      const openDateStr = formatDateBeijingYYYYMMDD(ms);
      servers.push({ id: serverNum, server_id: serverId, openDate: openDateStr });
    }

    // åˆæœè®°å½•ï¼ˆä¿æŒä¹‹å‰é…ç½®ï¼‰
    const mergeGroups = [
      { from: 2091, to: 2097, start: new Date("2025-10-18T00:00:00+08:00") },
      { from: 2098, to: 2104, start: new Date("2025-10-25T00:00:00+08:00") }
    ];

    function getBeijingNow() {
      const now = new Date();
      const utcMs = now.getTime() + now.getTimezoneOffset() * 60000;
      const beijingMs = utcMs + 8 * 3600000;
      return new Date(beijingMs);
    }
    function getBeijingStartOfToday() {
      const now = getBeijingNow();
      const y = now.getFullYear();
      const m = String(now.getMonth() + 1).padStart(2, '0');
      const d = String(now.getDate()).padStart(2, '0');
      return new Date(`${y}-${m}-${d}T00:00:00+08:00`);
    }

    const cardContainer = document.getElementById('cardContainer');

    function renderCards(){
      cardContainer.innerHTML = '';
      const beijingTodayStart = getBeijingStartOfToday();
      const now = getBeijingNow();
      const todayWeekday = now.getDay();
      const MS_PER_DAY = 24*60*60*1000;

      servers.forEach(server => {
        const url = `http://${currentDomain}/game.php?action=play&game_id=283&server_id=${server.server_id}`;
        const openDateStart = new Date(server.openDate + 'T00:00:00+08:00');
        const diffDays = Math.floor((beijingTodayStart - openDateStart)/MS_PER_DAY);

        let infoText = '';
        if (diffDays < 0) infoText = `å¼€æœå€’è®¡æ—¶ ${Math.abs(diffDays)} å¤©`;
        else if (diffDays < 7) infoText = `å¼€æœç¬¬ ${diffDays + 1} å¤©`;
        else infoText = `å¼€æœå…± ${diffDays + 1} å¤©`;

        // badges
        let badgesHTML = '';
        if (diffDays === 0) badgesHTML += `<span class="badge badge-new">ğŸ†• æ–°æœ</span>`;

        // æ£€æŸ¥æ˜¯å¦åˆæœç»„
        const mergeInfo = mergeGroups.find(g => server.id >= g.from && server.id <= g.to);
        if (mergeInfo) {
          const mergeDiffDays = Math.floor((beijingTodayStart - mergeInfo.start)/MS_PER_DAY);
          const mergeDay = mergeDiffDays >= 0 ? mergeDiffDays + 1 : 0;
          badgesHTML += `<span class="badge badge-merge">âš”ï¸ åˆæœç¬¬ ${mergeDay} å¤©</span>`;
          if (mergeDay === 3) badgesHTML += `<span class="badge badge-guild">ğŸ‘‘ å…¬ä¼šæˆ˜</span>`;
          if (mergeDay >= 3 && (todayWeekday === 3 || todayWeekday === 6)) badgesHTML += `<span class="badge badge-diamond">ğŸ’ æˆ˜æ—¥</span>`;
        } else {
          if (diffDays === 2) badgesHTML += `<span class="badge badge-guild">ğŸ‘‘ å…¬ä¼šæˆ˜</span>`;
          if (diffDays >= 3 && (todayWeekday === 3 || todayWeekday === 6)) badgesHTML += `<span class="badge badge-diamond">ğŸ’ æˆ˜æ—¥</span>`;
        }

        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
          <div class="title">åœ£ç‹ä¼ å¥‡${server.id}æœ</div>
          <div class="badges">${badgesHTML}</div>
          <div class="info">${infoText}</div>
        `;
        // ç‚¹å‡»è¡Œä¸ºï¼ˆå¤åˆ¶æˆ–æ‰“å¼€ï¼‰
        card.addEventListener('click', () => {
          if (currentMode === 'copy') copyText(url);
          else window.open(url, '_blank');
        });
        cardContainer.appendChild(card);
      });
    }

    function copyText(text){
      if (navigator.clipboard && navigator.clipboard.writeText) {
        navigator.clipboard.writeText(text).then(()=>showToast('å·²å¤åˆ¶é“¾æ¥åˆ°å‰ªè´´æ¿')).catch(()=>fallbackCopy(text));
      } else fallbackCopy(text);
    }
    function fallbackCopy(text){
      const ta = document.createElement('textarea');
      ta.value = text; ta.style.position='fixed'; ta.style.left='-9999px';
      document.body.appendChild(ta); ta.focus(); ta.select();
      try { document.execCommand('copy'); showToast('å·²å¤åˆ¶é“¾æ¥åˆ°å‰ªè´´æ¿'); } catch(e){}
      ta.remove();
    }

    // schedule daily refresh (keep previous behavior)
    function scheduleDailyRefresh() {
      const nowBeijing = getBeijingNow();
      const todayBeijingStart = getBeijingStartOfToday();
      const nextRefreshMs = todayBeijingStart.getTime() + 24*60*60*1000 + 1*60*1000;
      const msUntilNext = nextRefreshMs - nowBeijing.getTime();
      const initialDelay = msUntilNext > 0 ? msUntilNext : 1000;
      setTimeout(() => {
        renderCards();
        setInterval(renderCards, 12*60*60*1000);
      }, initialDelay);
    }

    // åˆæ¬¡æ¸²æŸ“
    renderCards();
    scheduleDailyRefresh();

    // ================= æ¸¸æˆåˆ—è¡¨ï¼ˆå…¶ä»–æ¸¸æˆï¼šä½¿ç”¨ä½ å‘çš„ç»“æ„ï¼Œå»æ‰ swcqï¼‰ =================
    const games = [
      {
        id: '111',
        name: 'æ»¡Våˆ‡å‰²ç¥åŸŸ',
        servers: [235, 236, 237, 248, 249, 250, 251, 252, 253, 254, 259, 260, 261,262, 263, 264, 265,275,276,277],
        lords: [262, 263, 264, 265,275,276],
        type: 'xayxms'
      },
      {
        id: '115',
        name: 'æ»¡Væ‚ ä¹…ä¼ å¥‡',
        type: 'xayxms',
        canHang: [105,112,113,114,115,116,119,120],
        cannotHang: [86,87,93,95,101,102,104,106,107,108,109,110,111,117,118,121,122,123],
        lords: [115,116,119,120]
      },
      {
        id: '137',
        name: 'GMèµ¤ç„°æ— åŒ',
        servers: [1, 2, 3, 4,5,6,7,8,9,10,11,12],
        type: 'xayxms'
      },
      {
        id: '962-115',
        name: '962yx',
        type: '962yx',
        mainAccount: [115,116],
        altAccount: [115,116,119,120,123],
        daiwan: [112,118,123]
      },
      {
        id: 'ydcs',
        name: 'ç‚é»ƒå¤§é™¸',
        servers: [543, 544, 545, 547, 548, 551],
        type: '1100yx'
      },
      {
        id: '88-7',
        name: 'å± ç¥',
        type: '8syx',
        servers: [25, 26, 30,31]
      }
    ];

    // æ¸²æŸ“â€œæ¸¸æˆåˆ—è¡¨â€æ ‡ç­¾å†…å®¹
    const gamesArea = document.getElementById('gamesArea');

    function getGameHomepageURL(gameId) {
      switch (gameId) {
        case '111': return 'http://gm.yx4f.com:81/games/111.html';
        case '115': return 'http://gm.yx4f.com:81/games/115.html';
        case '137': return 'http://gm.yx4f.com:81/games/137.html';
        case '962-115': return 'http://gm.962yx.com/games/115.html';
        case 'ydcs': return 'http://www.1100yx.com/game_list_8.html';
        case '88-7': return 'http://www.8syx.com/game/7/';
        default: return '#';
      }
    }

    function createGameSection(game) {
      const box = document.createElement('div');
      box.className = 'game-card';

      const title = document.createElement('div');
      title.className = 'game-section-title';
      title.textContent = game.name;
      box.appendChild(title);

      // If special sections
      if (game.mainAccount || game.altAccount || game.daiwan) {
        if (game.mainAccount) {
          const sec = document.createElement('div');
          sec.textContent = 'ğŸ‘‘ ä¸»å·';
          sec.style.fontWeight = '700';
          box.appendChild(sec);
          game.mainAccount.forEach(id=> {
            const a = document.createElement('a');
            a.href = `http://gm.962yx.com/login/115/${id}.html`;
            a.textContent = id + 'åŒº';
            a.target = '_blank';
            box.appendChild(a);
          });
        }
        if (game.altAccount) {
          const sec = document.createElement('div');
          sec.textContent = 'ğŸŒ€ å°å·';
          sec.style.fontWeight = '700';
          box.appendChild(sec);
          game.altAccount.forEach(id=> {
            const a = document.createElement('a');
            a.href = `http://gm.962yx.com/login/115/${id}.html`;
            a.textContent = id + 'åŒº';
            a.target = '_blank';
            box.appendChild(a);
          });
        }
        if (game.daiwan) {
          const sec = document.createElement('div');
          sec.textContent = 'ğŸ¯ ä»£ç©';
          sec.style.fontWeight = '700';
          box.appendChild(sec);
          game.daiwan.forEach(id=> {
            const a = document.createElement('a');
            a.href = `http://gm.962yx.com/login/115/${id}.html`;
            a.textContent = id + 'åŒº';
            a.target = '_blank';
            box.appendChild(a);
          });
        }
      } else if (game.canHang || game.cannotHang) {
        if (game.canHang && game.canHang.length){
          const sec = document.createElement('div');
          sec.textContent = 'âœ… åˆ·';
          sec.style.fontWeight = '700';
          box.appendChild(sec);
          game.canHang.forEach(id=>{
            const a = document.createElement('a');
            a.href = `http://gm.yx4f.com:81/login/${game.id}/${id}.html`;
            a.textContent = id + 'åŒº';
            a.target = '_blank';
            box.appendChild(a);
          });
        }
        if (game.cannotHang && game.cannotHang.length){
          const sec2 = document.createElement('div');
          sec2.textContent = 'â›” ç­¾åˆ°';
          sec2.style.fontWeight = '700';
          box.appendChild(sec2);
          game.cannotHang.forEach(id=>{
            const a = document.createElement('a');
            a.href = `http://gm.yx4f.com:81/login/${game.id}/${id}.html`;
            a.textContent = id + 'åŒº';
            a.target = '_blank';
            box.appendChild(a);
          });
        }
      } else if (game.servers && game.servers.length){
        game.servers.forEach(s => {
          const a = document.createElement('a');
          let realId = s;
          // for simple cases s is a number
          if (typeof s === 'object' && s.real) realId = s.real;
          // choose link by type
          if (game.type === '1100yx') a.href = `http://www.1100yx.com/Game_Login_8_${realId}.html`;
          else if (game.type === '8syx') a.href = `http://www.8syx.com/Game/gameto.php?gid=7&sid=${realId}`;
          else a.href = `http://gm.yx4f.com:81/login/${game.id}/${realId}.html`;
          a.textContent = (typeof s === 'object' && s.show) ? (s.show + 'åŒº') : (realId + 'åŒº');
          a.target = '_blank';
          if (game.lords && game.lords.includes(typeof s === 'object' ? s.show || s.real : s)) {
            a.style.borderColor = '#ff9800';
            a.style.background = '#fff7e6';
            a.style.color = '#e65100';
            a.style.fontWeight = '700';
          }
          box.appendChild(a);
        });
      }

      // add homepage link
      const home = document.createElement('div');
      home.style.marginTop = '8px';
      const homeLink = document.createElement('a');
      homeLink.href = getGameHomepageURL(game.id);
      homeLink.textContent = 'æ¸¸æˆä¸»é¡µ';
      homeLink.target = '_blank';
      box.appendChild(homeLink);

      return box;
    }

    // append all games
    games.forEach(g=>{
      const node = createGameSection(g);
      gamesArea.appendChild(node);
    });

    // ================= æ ‡ç­¾åˆ‡æ¢é€»è¾‘ =================
    document.querySelectorAll('.tab-btn').forEach(btn=>{
      btn.addEventListener('click', ()=> {
        document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active'));
        btn.classList.add('active');
        const tab = btn.getAttribute('data-tab');
        if (tab === 'swcq') {
          document.getElementById('tab-content-swcq').classList.remove('hidden');
          document.getElementById('tab-content-games').classList.add('hidden');
        } else {
          document.getElementById('tab-content-swcq').classList.add('hidden');
          document.getElementById('tab-content-games').classList.remove('hidden');
        }
      });
    });

    // åˆå§‹æ¿€æ´»ï¼šåœ£ç‹ä¼ å¥‡é¡µ
    document.querySelector('.tab-btn[data-tab="swcq"]').click();
  </script>

  <div class="footer-wrapper">
    <footer id="footer-container">åŠ è½½ä¸­...</footer>
  </div>
  <script src="/load-footer.js"></script>
</body>
</html>
