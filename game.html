<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ğŸ® æ¸¸æˆåŒºæœå¯¼èˆª</title>
  <!-- è½½å…¥ footer æ ·å¼ -->
<link rel="stylesheet" href="/footer.css" />
<!-- è½½å…¥ footer æ ·å¼ -->
<style>
:root {
  --bg: #0b1428;
  --card: #111a33;
  --accent: #06b6d4;
  --hover: #0891b2;
  --text: #e5eef8;
  --muted: #9aa4b2;
}
body {
  background: var(--bg);
  color: var(--text);
  font-family: "Microsoft YaHei", Arial, sans-serif;
  margin: 0;
  padding: 12px;
}
.container {
  max-width: 1000px;
  margin: 0 auto;
}
h1 {
  text-align: center;
  font-size: 20px;
  margin-bottom: 8px;
}
#time {
  text-align: center;
  color: var(--muted);
  font-size: 14px;
  margin-bottom: 10px;
}
.tabs {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 8px;
  margin-bottom: 12px;
}
.tab {
  padding: 6px 12px;
  border-radius: 8px;
  background: #1a233c;
  color: var(--muted);
  border: 1px solid #1e293b;
  cursor: pointer;
  font-weight: 700;
}
.tab.active {
  background: linear-gradient(90deg, var(--accent), #7dd3fc);
  color: #022;
  border: none;
}
.controls {
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
  gap: 8px;
  margin-bottom: 12px;
}
.control-btn {
  border: 1px solid #1e293b;
  border-radius: 8px;
  padding: 8px 14px;
  font-weight: 700;
  background: #1a233c;
  color: var(--muted);
  cursor: pointer;
}
.control-btn.active {
  background: linear-gradient(90deg, var(--accent), #7dd3fc);
  color: #022;
  border: none;
}
.grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  gap: 10px;
}
.card {
  background: var(--card);
  border-radius: 12px;
  padding: 10px;
  text-align: center;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.4);
}
.title {
  font-weight: bold;
  margin-bottom: 6px;
}
.btn {
  display: inline-block;
  background: #1f2a4a;
  color: var(--text);
  padding: 8px 10px;
  border-radius: 8px;
  border: 1px solid #2b3a5c;
  cursor: pointer;
  font-weight: 700;
  font-size: 14px;
  text-decoration: none;
  width: 100%;
  box-sizing: border-box;
}
.btn:hover {
  background: var(--hover);
  color: #022;
}
.badges {
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
  gap: 4px;
  margin-top: 6px;
}
.badge {
  background: var(--accent);
  color: #022;
  border-radius: 999px;
  padding: 2px 8px;
  font-size: 12px;
  font-weight: bold;
}
.badge-event {
  background: #f59e0b;
  color: #111;
}
.badge-platform {
  background: #8b5cf6;
  color: #fff;
}
.badge-check {
  background: #10b981;
  color: white;
}
.badge-custom {
  background: #f97316;
  color: white;
}
#toast {
  position: fixed;
  bottom: 30px;
  left: 50%;
  transform: translateX(-50%);
  background: var(--accent);
  color: #022;
  padding: 10px 18px;
  border-radius: 999px;
  font-weight: 700;
  box-shadow: 0 4px 12px rgba(6, 22, 34, 0.5);
  display: none;
  z-index: 999;
}
footer {
  text-align: center;
  color: var(--muted);
  font-size: 13px;
  margin-top: 15px;
}
.platform-switcher {
  display: flex;
  justify-content: center;
  gap: 8px;
  margin: 10px 0;
  flex-wrap: wrap;
}
.platform-btn {
  padding: 6px 12px;
  border-radius: 8px;
  background: #1a233c;
  color: var(--muted);
  border: 1px solid #2b3a5c;
  cursor: pointer;
  font-weight: 600;
  font-size: 14px;
}
.platform-btn.active {
  background: linear-gradient(90deg, #8b5cf6, #a78bfa);
  color: white;
  border: none;
}
.server-info {
  font-size: 12px;
  color: var(--muted);
  margin-top: 4px;
}
.check-mark {
  color: #10b981;
  margin-left: 4px;
  font-weight: bold;
}
.status-indicator {
  display: inline-block;
  width: 8px;
  height: 8px;
  border-radius: 50%;
  margin-right: 6px;
}
.status-open {
  background-color: #10b981;
}
.id-info {
  font-family: monospace;
  font-size: 11px;
  color: #9ca3af;
  margin-top: 2px;
}
.simple-title {
  font-weight: bold;
  font-size: 16px;
  margin-bottom: 8px;
}
.swcq-simple-card {
  background: var(--card);
  border-radius: 12px;
  padding: 12px;
  text-align: center;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.4);
}
.swcq-check {
  color: #10b981;
  margin-left: 4px;
}
.json-input-container {
  margin: 10px 0;
  text-align: center;
}
.json-textarea {
  width: 100%;
  max-width: 600px;
  height: 80px;
  background: #1a233c;
  color: var(--text);
  border: 1px solid #2b3a5c;
  border-radius: 8px;
  padding: 10px;
  font-family: monospace;
  font-size: 12px;
  resize: vertical;
  margin-bottom: 8px;
}
.json-btn {
  background: linear-gradient(90deg, #f97316, #fb923c);
  color: white;
  border: none;
  border-radius: 8px;
  padding: 8px 16px;
  font-weight: 600;
  cursor: pointer;
  font-size: 14px;
}
.json-btn:hover {
  background: linear-gradient(90deg, #ea580c, #f97316);
}
</style>
</head>
<body>
<div class="container">
  <div id="time">åŒ—äº¬æ—¶é—´åŠ è½½ä¸­â€¦</div>
  <div class="controls">
    <button id="btnCopy" class="control-btn active">ğŸ“‹ å¤åˆ¶æ¨¡å¼</button>
    <button id="btnOpen" class="control-btn">ğŸ”— æ‰“å¼€æ¨¡å¼</button>
  </div>
  <div class="tabs" id="tabs"></div>
  
  <!-- å¹³å°åˆ‡æ¢å™¨ - åŠ¨æ€æ˜¾ç¤º -->
  <div id="platformSwitcher" class="platform-switcher" style="display: none;"></div>
  
  <!-- JSONè‡ªå®šä¹‰åŒºæœè¾“å…¥æ¡† -->
  <div id="jsonInputContainer" class="json-input-container" style="display: none;">
    <textarea id="jsonInput" class="json-textarea" placeholder='è¾“å…¥è‡ªå®šä¹‰åŒºæœJSONï¼Œæ ¼å¼å¦‚ï¼š{"2183": 136339, "2195": 136351}
ä¸€è¡Œä¸€ä¸ªï¼ŒåŒºæœ:ID
æ”¯æŒæ‰¹é‡æ·»åŠ ï¼Œä¾‹å¦‚ï¼š
{"2183": 136339, "2195": 136351, "2200": 136356}'></textarea>
    <button id="applyJsonBtn" class="json-btn">åº”ç”¨è‡ªå®šä¹‰åŒºæœ</button>
  </div>
  
  <div id="content"></div>
  <div id="toast"></div>
  <footer>å·²å°±ç»ª</footer>
</div>
<script>
let clickMode = 'copy';
let currentPlatform = '9awan'; // åœ£ç‹ä¼ å¥‡é»˜è®¤å¹³å°
let currentYJ = 'yx4f'; // æ‚ ä¹…ä¼ å¥‡é»˜è®¤å¹³å°
const MS_DAY = 86400000;

// å­˜å‚¨è‡ªå®šä¹‰åŒºæœæ˜ å°„
let customServersMap = {};

// è·å–ä»Šå¤©çš„æ—¥æœŸï¼ˆåŒ—äº¬æ—¶é—´ï¼‰
function getTodayDate() {
  const now = new Date();
  const bj = new Date(now.getTime() + (8 * 60 - now.getTimezoneOffset()) * 60000);
  return bj.toLocaleDateString('zh-CN', { year: 'numeric', month: '2-digit', day: '2-digit' }).replace(/\//g, '-');
}

// è®¡ç®—ä»Šå¤©æ˜¯å‘¨å‡ ï¼ˆ0-6ï¼Œ0æ˜¯å‘¨æ—¥ï¼‰
function getTodayWeekday() {
  const now = new Date();
  const bj = new Date(now.getTime() + (8 * 60 - now.getTimezoneOffset()) * 60000);
  return bj.getDay(); // 0=å‘¨æ—¥, 1=å‘¨ä¸€, ..., 6=å‘¨å…­
}

// è®¡ç®—ä¸¤ä¸ªæ—¥æœŸä¹‹é—´çš„å¤©æ•°å·®
function getDaysBetween(date1, date2) {
  const d1 = new Date(date1);
  const d2 = new Date(date2);
  const diffTime = Math.abs(d2 - d1);
  return Math.ceil(diffTime / MS_DAY);
}

// è§£æJSONè¾“å…¥
function parseCustomJson(jsonStr) {
  try {
    if (!jsonStr.trim()) {
      return {};
    }
    
    // å°è¯•è§£æJSON
    const parsed = JSON.parse(jsonStr);
    
    // éªŒè¯æ ¼å¼
    if (typeof parsed !== 'object' || parsed === null) {
      throw new Error('JSONæ ¼å¼é”™è¯¯ï¼šå¿…é¡»æ˜¯å¯¹è±¡æ ¼å¼');
    }
    
    // è½¬æ¢é”®ä¸ºæ•°å­—
    const result = {};
    for (const [key, value] of Object.entries(parsed)) {
      const showId = parseInt(key);
      const realId = parseInt(value);
      
      if (isNaN(showId) || isNaN(realId)) {
        throw new Error(`æ— æ•ˆçš„æ•°å­—æ ¼å¼ï¼š${key}: ${value}`);
      }
      
      result[showId] = realId;
    }
    
    return result;
  } catch (error) {
    toast('JSONè§£æé”™è¯¯ï¼š' + error.message);
    console.error('JSONè§£æé”™è¯¯:', error);
    return null;
  }
}

// æ¸¸æˆæ•°æ®é…ç½®
const games = [
  {
    id: 'swcq',
    name: 'åœ£ç‹ä¼ å¥‡',
    platforms: {
      '9awan': {
        name: '9aç©å¹³å°',
        homepage: 'http://www.9awan.com/home/server/283',
        serverUrlTemplate: 'http://www.9awan.com/game.php?action=play&game_id=283&server_id=',
        servers: Array.from({length: 2116 - 2091 + 1}, (_, i) => ({show: 2091 + i, real: 98471 + i}))
      },
      '3uyy': {
        name: '3UYYå¹³å°',
        homepage: 'http://88.3uyy.com/home/server/283',
        serverUrlTemplate: 'http://88.3uyy.com/game.php?action=play&game_id=283&server_id=',
        servers: Array.from({length: 2116 - 2091 + 1}, (_, i) => ({show: 2091 + i, real: 98471 + i}))
      },
      'aa4': {
        name: 'AA4å¹³å°',
        homepage: 'http://www.aa4.cn/webgame/kaifu/552',
        serverUrlTemplate: 'http://www.aa4.cn/webgame/into/552/',
        // AA4å¹³å°åŒºæœé…ç½®ï¼šæ ¹æ®æ—¥æœŸåŠ¨æ€å¼€æ”¾
        getServers: function() {
          const today = getTodayDate();
          const baseDate = '2026-01-14'; // 2191åŒºå¼€å¯çš„åŸºå‡†æ—¥æœŸ
          
          // ä»2178åŒºå¼€å§‹ï¼ŒIDæ˜¯136334ï¼Œç„¶åé€’å¢
          // æ ¹æ®æ˜¾ç¤ºç¼–å·è®¡ç®—çœŸå®ID
          const calculateRealId = (showId) => {
            // 2178åŒºå¯¹åº”136334
            const baseShowId = 2178;
            const baseRealId = 136334;
            
            // é¦–å…ˆæ£€æŸ¥è‡ªå®šä¹‰æ˜ å°„
            if (customServersMap[showId]) {
              return customServersMap[showId];
            }
            
            // å¦åˆ™ä½¿ç”¨æ ‡å‡†è®¡ç®—
            return baseRealId + (showId - baseShowId);
          };
          
          // åŸºç¡€åŒºæœæ•°æ®ï¼šæ˜¾ç¤ºç¼–å·ã€çœŸå®IDã€å¼€æ”¾æ—¥æœŸ
          const serverData = [
            // å·²å¼€æ”¾åŒºæœ (2168-2177ï¼Œä½¿ç”¨æ—§çš„ID)
            {show: 2168, real: 136262, openDate: '2024-01-01', special: false},
            {show: 2169, real: 136263, openDate: '2024-01-01', special: false},
            {show: 2170, real: 136264, openDate: '2024-01-01', special: false},
            {show: 2171, real: 136265, openDate: '2024-01-01', special: true},  // âœ…
            {show: 2172, real: 136266, openDate: '2024-01-01', special: false},
            {show: 2173, real: 136267, openDate: '2024-01-01', special: false},
            {show: 2174, real: 136268, openDate: '2024-01-01', special: false},
            {show: 2175, real: 136269, openDate: '2024-01-01', special: true},  // âœ…
            {show: 2176, real: 136270, openDate: '2024-01-01', special: false},
            {show: 2177, real: 136271, openDate: '2024-01-01', special: false},
            
            // ä»2178åŒºå¼€å§‹ä½¿ç”¨æ–°çš„IDè®¡ç®—è§„åˆ™
            {show: 2178, real: calculateRealId(2178), openDate: '2026-01-01', special: false, isCustom: customServersMap[2178] !== undefined},
            {show: 2179, real: calculateRealId(2179), openDate: '2026-01-01', special: false, isCustom: customServersMap[2179] !== undefined},
            {show: 2180, real: calculateRealId(2180), openDate: '2026-01-01', special: false, isCustom: customServersMap[2180] !== undefined},
            {show: 2181, real: calculateRealId(2181), openDate: '2026-01-01', special: false, isCustom: customServersMap[2181] !== undefined},
            {show: 2182, real: calculateRealId(2182), openDate: '2026-01-01', special: false, isCustom: customServersMap[2182] !== undefined},
            {show: 2183, real: calculateRealId(2183), openDate: '2026-01-01', special: false, isCustom: customServersMap[2183] !== undefined},
            {show: 2185, real: calculateRealId(2185), openDate: '2026-01-01', special: false, isCustom: customServersMap[2185] !== undefined},
            {show: 2186, real: calculateRealId(2186), openDate: '2026-01-01', special: false, isCustom: customServersMap[2186] !== undefined},
            {show: 2187, real: calculateRealId(2187), openDate: '2026-01-01', special: false, isCustom: customServersMap[2187] !== undefined},
            {show: 2188, real: calculateRealId(2188), openDate: '2026-01-01', special: false, isCustom: customServersMap[2188] !== undefined},
            {show: 2189, real: calculateRealId(2189), openDate: '2026-01-01', special: false, isCustom: customServersMap[2189] !== undefined},
            {show: 2190, real: calculateRealId(2190), openDate: '2026-01-01', special: false, isCustom: customServersMap[2190] !== undefined},
          ];
          
          // è®¡ç®—ä»Šå¤©è·ç¦»åŸºå‡†æ—¥æœŸçš„å¤©æ•°
          const daysFromBase = getDaysBetween(baseDate, today);
          
          // 2191åŒºåŠä»¥åçš„æœ€å¤§åŒºæœç¼–å·ï¼ˆæ¯å¤©å¼€ä¸€ä¸ªæ–°åŒºï¼‰
          const maxServerShowId = 2191 + Math.max(0, daysFromBase);
          
          // åŠ¨æ€ç”Ÿæˆ2191åŠä»¥åçš„åŒºæœ
          for (let showId = 2191; showId <= maxServerShowId; showId++) {
            // è®¡ç®—å¼€æ”¾æ—¥æœŸï¼šåŸºå‡†æ—¥æœŸ + (åŒºæœç¼–å·-2191)å¤©
            const openDate = new Date(baseDate);
            openDate.setDate(openDate.getDate() + (showId - 2191));
            const openDateStr = openDate.toLocaleDateString('zh-CN', { year: 'numeric', month: '2-digit', day: '2-digit' }).replace(/\//g, '-');
            
            const isCustom = customServersMap[showId] !== undefined;
            
            serverData.push({
              show: showId,
              real: calculateRealId(showId),
              openDate: openDateStr,
              special: false,
              isCustom: isCustom
            });
          }
          
          // è¿‡æ»¤å‡ºä»Šå¤©åŠä¹‹å‰å¼€æ”¾çš„åŒºæœ
          const todayServers = serverData.filter(server => {
            return this.isDateBeforeOrEqual(server.openDate, today);
          });
          
          console.log(`ä»Šå¤©æ—¥æœŸ: ${today}, åŸºå‡†æ—¥æœŸ: ${baseDate}, å¤©æ•°å·®: ${daysFromBase}`);
          console.log(`æœ€å¤§å¼€æ”¾åŒºæœ: ${maxServerShowId}, å®é™…å¼€æ”¾åŒºæœæ•°: ${todayServers.length}`);
          console.log(`è‡ªå®šä¹‰åŒºæœæ˜ å°„:`, customServersMap);
          
          return todayServers;
        },
        
        // è¾…åŠ©å‡½æ•°ï¼šæ¯”è¾ƒæ—¥æœŸ
        isDateBeforeOrEqual: function(date1, date2) {
          const d1 = new Date(date1);
          const d2 = new Date(date2);
          return d1 <= d2;
        }
      }
    },
    merges: [
      {from:2091,to:2097,date:'2025-10-28'},
      {from:2098,to:2104,date:'2025-10-31'},
      {from:2105,to:2111,date:'2025-11-02'}
    ],
    isMultiPlatform: true
  },
  {
    id: '111',
    name: 'æ»¡Våˆ‡å‰²ç¥åŸŸ',
    homepage: 'http://gm.yx4f.com:81/games/111.html',
    servers: [235,236,237,248,249,250,251,252,253,254,259,260,261,262,263,264,265,275,276,277],
    isMultiPlatform: false
  },
  {
    id: '115',
    name: 'æ»¡Væ‚ ä¹…ä¼ å¥‡',
    platforms: {
      'yx4f': {
        name: 'YX4Få¹³å°',
        homepage: 'http://gm.yx4f.com:81/games/115.html',
        serverUrlTemplate: 'http://gm.yx4f.com:81/login/115/',
        // åŸæœ‰1-123åŒºï¼Œæ–°å¢124-132åŒº
        servers: [
          // åŸæœ‰åŒºæœ 1-123
          1, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123,
          // æ–°å¢åŒºæœ 124-132
          124, 125, 126, 127, 128, 129, 130, 131, 132
        ]
      },
      '962yx': {
        name: '962YXå¹³å°',
        homepage: 'http://gm.962yx.com/games/115.html',
        serverUrlTemplate: 'http://gm.962yx.com/login/115/',
        // åŸæœ‰1-123åŒºï¼Œæ–°å¢124-132åŒº
        servers: [
          // åŸæœ‰åŒºæœ 1-123
          1, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123,
          // æ–°å¢åŒºæœ 124-132
          124, 125, 126, 127, 128, 129, 130, 131, 132
        ]
      }
    },
    isMultiPlatform: true
  },
  {
    id: '137',
    name: 'GMèµ¤ç„°æ— åŒ',
    homepage: 'http://gm.yx4f.com:81/games/137.html',
    servers: [1,2,3,4,5,6,7,8,9,10,11,12],
    isMultiPlatform: false
  },
  {
    id: 'ts',
    name: 'å± ç¥',
    homepage: 'http://www.8syx.com/game/7/',
    servers: [25,26,30,31,35],
    isMultiPlatform: false
  }
];

const toast = (msg)=>{
  const t = document.getElementById('toast');
  t.textContent = msg; t.style.display='block'; t.style.opacity='1';
  setTimeout(()=>{t.style.transition='opacity .3s'; t.style.opacity='0';
  setTimeout(()=>t.style.display='none',300);},1400);
};

function daysSince(dateStr){
  const s = new Date(dateStr+'T00:00:00+08:00');
  const t = new Date();
  const now = new Date(t.getTime()+(8*60 - t.getTimezoneOffset())*60000);
  const d = new Date(now.toLocaleDateString('en-CA')+'T00:00:00+08:00');
  return Math.floor((d-s)/MS_DAY)+1;
}

function renderTabs(){
  const tabs = document.getElementById('tabs');
  tabs.innerHTML='';
  games.forEach(g=>{
    const b=document.createElement('button');
    b.className='tab'+(g.id==='swcq'?' active':'');
    b.textContent=g.name;
    b.onclick=()=>{
      document.querySelectorAll('.tab').forEach(x=>x.classList.remove('active'));
      b.classList.add('active');
      showPlatformSwitcher(g.id);
      showJsonInput(g.id);
      renderContent(g.id);
    };
    tabs.appendChild(b);
  });
}

function showPlatformSwitcher(gameId){
  const switcher = document.getElementById('platformSwitcher');
  const game = games.find(g => g.id === gameId);
  
  if (game && game.isMultiPlatform) {
    switcher.style.display = 'flex';
    // æ¸…é™¤ç°æœ‰æŒ‰é’®
    switcher.innerHTML = '';
    
    // ä¸ºæ¯ä¸ªå¹³å°åˆ›å»ºæŒ‰é’®
    Object.entries(game.platforms).forEach(([platformId, platform], index) => {
      const btn = document.createElement('button');
      
      // è®¾ç½®é»˜è®¤é€‰ä¸­çŠ¶æ€
      let isActive = false;
      if (gameId === 'swcq') {
        isActive = platformId === currentPlatform;
      } else if (gameId === '115') {
        isActive = platformId === currentYJ;
      }
      
      btn.className = `platform-btn ${isActive ? 'active' : ''}`;
      btn.textContent = platform.name;
      btn.dataset.platform = platformId;
      btn.dataset.gameId = gameId; // æ·»åŠ æ¸¸æˆIDæ ‡è¯†
      btn.onclick = () => {
        // ç§»é™¤æ‰€æœ‰æŒ‰é’®çš„activeçŠ¶æ€
        document.querySelectorAll('.platform-btn').forEach(x => x.classList.remove('active'));
        btn.classList.add('active');
        
        // æ ¹æ®æ¸¸æˆIDæ›´æ–°å¯¹åº”çš„å¹³å°å˜é‡
        if (gameId === 'swcq') {
          currentPlatform = platformId;
        } else if (gameId === '115') {
          currentYJ = platformId;
        }
        
        toast(`å·²åˆ‡æ¢è‡³ ${platform.name}`);
        renderContent(gameId);
      };
      switcher.appendChild(btn);
    });
  } else {
    switcher.style.display = 'none';
  }
}

function showJsonInput(gameId){
  const jsonContainer = document.getElementById('jsonInputContainer');
  const game = games.find(g => g.id === gameId);
  
  // åªåœ¨AA4å¹³å°çš„åœ£ç‹ä¼ å¥‡æ˜¾ç¤ºJSONè¾“å…¥æ¡†
  if (game && game.id === 'swcq' && currentPlatform === 'aa4') {
    jsonContainer.style.display = 'block';
  } else {
    jsonContainer.style.display = 'none';
  }
}

function renderContent(id){
  const box = document.getElementById('content');
  box.innerHTML='';
  const game = games.find(x => x.id === id);
  if(!game) return;
  
  const grid = document.createElement('div');
  grid.className='grid';

  if(id === 'swcq'){
    // åœ£ç‹ä¼ å¥‡ - å¤šå¹³å°æ”¯æŒ
    const platform = game.platforms[currentPlatform];
    
    // ä¸»é¡µæŒ‰é’®
    const homeBtn = document.createElement('a');
    homeBtn.className = 'btn';
    homeBtn.textContent = 'ğŸ“… å¼€æœè¡¨';
    homeBtn.href = platform.homepage;
    homeBtn.target = '_blank';
    const homeCard = document.createElement('div');
    homeCard.className = 'card';
    homeCard.appendChild(homeBtn);
    grid.appendChild(homeCard);
    
    // æ·»åŠ å¹³å°æ ‡è¯†
    const platformBadge = document.createElement('div');
    platformBadge.className = 'badge badge-platform';
    platformBadge.textContent = platform.name;
    homeCard.appendChild(platformBadge);

    const today = getTodayDate();
    
    // è·å–å½“å‰å¼€æ”¾çš„åŒºæœï¼ˆAA4å¹³å°åŠ¨æ€è·å–ï¼‰
    const servers = currentPlatform === 'aa4' ? platform.getServers() : platform.servers;
    
    // æ˜¾ç¤ºä»Šæ—¥ä¿¡æ¯
    const infoCard = document.createElement('div');
    infoCard.className = 'card';
    const infoTitle = document.createElement('div');
    infoTitle.className = 'title';
    infoTitle.textContent = `ğŸ“… ${today}`;
    infoCard.appendChild(infoTitle);
    
    const serverCount = document.createElement('div');
    serverCount.textContent = `å¼€æ”¾åŒºæœï¼š${servers.length}ä¸ª`;
    serverCount.style.fontSize = '14px';
    serverCount.style.color = 'var(--accent)';
    serverCount.style.marginTop = '4px';
    infoCard.appendChild(serverCount);
    
    // æ˜¾ç¤ºè‡ªå®šä¹‰åŒºæœæ•°é‡
    const customCount = Object.keys(customServersMap).length;
    if (currentPlatform === 'aa4' && customCount > 0) {
      const customInfo = document.createElement('div');
      customInfo.textContent = `è‡ªå®šä¹‰åŒºæœï¼š${customCount}ä¸ª`;
      customInfo.style.fontSize = '12px';
      customInfo.style.color = '#f97316';
      customInfo.style.marginTop = '2px';
      infoCard.appendChild(customInfo);
    }
    
    // æ˜¾ç¤ºIDè®¡ç®—è§„åˆ™ï¼ˆä»…AA4å¹³å°ï¼‰
    if (currentPlatform === 'aa4' && servers.length > 0) {
      const idRule = document.createElement('div');
      idRule.className = 'id-info';
      idRule.textContent = 'IDè§„åˆ™ï¼š2178åŒº=136334ï¼Œä¹‹åæ¯ä¸ªåŒº+1';
      idRule.style.marginTop = '6px';
      infoCard.appendChild(idRule);
      
      // æ˜¾ç¤ºå¼€æœè§„åˆ™
      const openRule = document.createElement('div');
      openRule.className = 'id-info';
      openRule.textContent = 'å¼€æœè§„åˆ™ï¼š2026/01/14å¼€å¯2191åŒºï¼Œä¹‹åæ¯å¤©å¼€ä¸€ä¸ªæ–°åŒº';
      openRule.style.marginTop = '2px';
      infoCard.appendChild(openRule);
    }
    
    grid.appendChild(infoCard);
    
    // æ¸²æŸ“åŒºæœå¡ç‰‡ - ç®€åŒ–ç‰ˆæœ¬
    servers.forEach(s => {
      const card = document.createElement('div');
      card.className = 'swcq-simple-card';
      
      // æ ‡é¢˜éƒ¨åˆ† - åªæ˜¾ç¤ºåŒºæœç¼–å·ï¼Œ2171å’Œ2175åŠ âœ…
      const title = document.createElement('div');
      title.className = 'simple-title';
      
      if (currentPlatform === 'aa4' && (s.show === 2171 || s.show === 2175)) {
        title.innerHTML = `${s.show}åŒº <span class="swcq-check">âœ…</span>`;
      } else {
        title.textContent = `${s.show}åŒº`;
      }
      card.appendChild(title);
      
      // æ˜¾ç¤ºæœåŠ¡å™¨IDä¿¡æ¯ï¼ˆä»…AA4å¹³å°ï¼‰
      if (currentPlatform === 'aa4') {
        const info = document.createElement('div');
        info.className = 'server-info';
        info.textContent = `ID: ${s.real}`;
        if (s.isCustom) {
          info.style.color = '#f97316';
          info.style.fontWeight = 'bold';
        }
        card.appendChild(info);
      }
      
      // æ„å»ºé“¾æ¥
      let url;
      if (currentPlatform === 'aa4') {
        // AA4å¹³å°é“¾æ¥æ ¼å¼ï¼šhttp://www.aa4.cn/webgame/into/552/æœåŠ¡å™¨çœŸå®ID
        url = `${platform.serverUrlTemplate}${s.real}`;
      } else {
        // 9awanå’Œ3uyyå¹³å°
        url = `${platform.serverUrlTemplate}${s.real}`;
      }
      
      const btn = document.createElement('a');
      btn.className = 'btn';
      btn.textContent = 'ç‚¹å‡»åŒºæœ';
      btn.onclick = (e) => {
        e.preventDefault();
        if(clickMode === 'open'){
          window.open(url, '_blank');
        } else {
          navigator.clipboard.writeText(url);
          toast('å·²å¤åˆ¶é“¾æ¥');
        }
      };
      card.appendChild(btn);
      
      // æ˜¾ç¤ºè‡ªå®šä¹‰å¾½ç« 
      if (s.isCustom) {
        const badges = document.createElement('div');
        badges.className = 'badges';
        
        const customBadge = document.createElement('div');
        customBadge.className = 'badge badge-custom';
        customBadge.textContent = 'è‡ªå®šä¹‰';
        badges.appendChild(customBadge);
        
        card.appendChild(badges);
      }
      
      grid.appendChild(card);
    });
    
  } else if(id === '115'){
    // æ»¡Væ‚ ä¹…ä¼ å¥‡ - å¤šå¹³å°æ”¯æŒ
    const platform = game.platforms[currentYJ];
    
    // ä¸»é¡µæŒ‰é’®
    const homeBtn = document.createElement('a');
    homeBtn.className = 'btn';
    homeBtn.textContent = 'ğŸ  æ¸¸æˆä¸»é¡µ';
    homeBtn.href = platform.homepage;
    homeBtn.target = '_blank';
    const homeCard = document.createElement('div');
    homeCard.className = 'card';
    homeCard.appendChild(homeBtn);
    grid.appendChild(homeCard);
    
    // æ·»åŠ å¹³å°æ ‡è¯†
    const platformBadge = document.createElement('div');
    platformBadge.className = 'badge badge-platform';
    platformBadge.textContent = platform.name;
    homeCard.appendChild(platformBadge);
    
    // æ˜¾ç¤ºå½“å‰å¹³å°å’ŒåŒºæœç»Ÿè®¡
    const statsCard = document.createElement('div');
    statsCard.className = 'card';
    const statsTitle = document.createElement('div');
    statsTitle.className = 'title';
    statsTitle.textContent = `ğŸ“Š åŒºæœç»Ÿè®¡`;
    statsCard.appendChild(statsTitle);
    
    const serverCountInfo = document.createElement('div');
    serverCountInfo.textContent = `æ€»åŒºæœæ•°: ${platform.servers.length}ä¸ª`;
    serverCountInfo.style.fontSize = '14px';
    serverCountInfo.style.color = 'var(--accent)';
    statsCard.appendChild(serverCountInfo);
    
    const serverRangeInfo = document.createElement('div');
    serverRangeInfo.textContent = `èŒƒå›´: 1-123, 124-132åŒº`;
    serverRangeInfo.style.fontSize = '12px';
    serverRangeInfo.style.color = 'var(--muted)';
    serverRangeInfo.style.marginTop = '2px';
    statsCard.appendChild(serverRangeInfo);
    
    grid.appendChild(statsCard);
    
    // åŒºæœåˆ—è¡¨
    platform.servers.forEach(s => {
      const card = document.createElement('div');
      card.className = 'card';
      
      const title = document.createElement('div');
      title.className = 'title';
      title.textContent = `${s}åŒº`;
      card.appendChild(title);
      
      const url = `${platform.serverUrlTemplate}${s}.html`;
      const btn = document.createElement('a');
      btn.className = 'btn';
      btn.textContent = 'ç‚¹å‡»åŒºæœ';
      btn.onclick = (e) => {
        e.preventDefault();
        if(clickMode === 'open'){
          window.open(url, '_blank');
        } else {
          navigator.clipboard.writeText(url);
          toast('å·²å¤åˆ¶é“¾æ¥');
        }
      };
      card.appendChild(btn);
      
      grid.appendChild(card);
    });
    
  } else {
    // å…¶ä»–å•å¹³å°æ¸¸æˆ
    const homeBtn = document.createElement('a');
    homeBtn.className = 'btn';
    homeBtn.textContent = 'ğŸ  æ¸¸æˆä¸»é¡µ';
    homeBtn.href = game.homepage;
    homeBtn.target = '_blank';
    const hcard = document.createElement('div');
    hcard.className = 'card';
    hcard.appendChild(homeBtn);
    grid.appendChild(hcard);
    
    game.servers.forEach(s => {
      const card = document.createElement('div');
      card.className = 'card';
      const title = document.createElement('div');
      title.className = 'title';
      title.textContent = `${s}åŒº`;
      card.appendChild(title);
      
      let url = '#';
      if(id === '111'){
        url = `http://gm.yx4f.com:81/login/111/${s}.html`;
      } else if(id === '137'){
        url = `http://gm.yx4f.com:81/login/137/${s}.html`;
      } else if(id === 'ts'){
        url = `http://www.8syx.com/Game/gameto.php?gid=7&sid=${s}`;
      }
      
      const btn = document.createElement('a');
      btn.className = 'btn';
      btn.textContent = 'ç‚¹å‡»åŒºæœ';
      btn.onclick = (e) => {
        e.preventDefault();
        if(clickMode === 'open'){
          window.open(url, '_blank');
        } else {
          navigator.clipboard.writeText(url);
          toast('å·²å¤åˆ¶é“¾æ¥');
        }
      };
      card.appendChild(btn);
      grid.appendChild(card);
    });
  }
  
  box.appendChild(grid);
}

function init(){
  // æ›´æ–°æ—¶é—´æ˜¾ç¤º
  const tick = () => {
    const now = new Date();
    const bj = new Date(now.getTime()+(8*60-now.getTimezoneOffset())*60000);
    document.getElementById('time').textContent = 'åŒ—äº¬æ—¶é—´ï¼š'+bj.toLocaleString('zh-CN',{hour12:false});
    
    // æ¯åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡æ˜¯å¦éœ€è¦åˆ·æ–°ï¼ˆç”¨äºè·¨æ—¥åˆ·æ–°ï¼‰
    const minutes = bj.getMinutes();
    if (minutes === 0) {
      // æ•´ç‚¹æ—¶æ£€æŸ¥ï¼Œå¦‚æœæ˜¯0ç‚¹åˆ™åˆ·æ–°é¡µé¢å†…å®¹
      const hours = bj.getHours();
      if (hours === 0 && currentPlatform === 'aa4') {
        console.log('æ£€æµ‹åˆ°æ–°çš„ä¸€å¤©ï¼Œåˆ·æ–°AA4åŒºæœåˆ—è¡¨');
        renderContent('swcq');
      }
    }
  };
  tick();
  setInterval(tick, 60000); // æ¯åˆ†é’Ÿæ›´æ–°ä¸€æ¬¡æ—¶é—´
  
  // æ¯ç§’æ›´æ–°æ—¶é—´æ˜¾ç¤º
  setInterval(() => {
    const now = new Date();
    const bj = new Date(now.getTime()+(8*60-now.getTimezoneOffset())*60000);
    document.getElementById('time').textContent = 'åŒ—äº¬æ—¶é—´ï¼š'+bj.toLocaleString('zh-CN',{hour12:false});
  }, 1000);
  
  // æ¸²æŸ“æ ‡ç­¾é¡µ
  renderTabs();
  
  // æ˜¾ç¤ºå¹³å°åˆ‡æ¢å™¨ï¼ˆåˆå§‹æ˜¾ç¤ºåœ£ç‹ä¼ å¥‡çš„ï¼‰
  showPlatformSwitcher('swcq');
  
  // æ˜¾ç¤ºJSONè¾“å…¥æ¡†
  showJsonInput('swcq');
  
  // åˆå§‹æ¸²æŸ“å†…å®¹
  renderContent('swcq');
  
  // ç»‘å®šæ§åˆ¶æŒ‰é’®äº‹ä»¶
  const btnCopy = document.getElementById('btnCopy');
  const btnOpen = document.getElementById('btnOpen');
  
  btnCopy.onclick = () => {
    clickMode = 'copy';
    btnCopy.classList.add('active');
    btnOpen.classList.remove('active');
    toast('å¤åˆ¶æ¨¡å¼');
  };
  
  btnOpen.onclick = () => {
    clickMode = 'open';
    btnOpen.classList.add('active');
    btnCopy.classList.remove('active');
    toast('æ‰“å¼€æ¨¡å¼');
  };
  
  // ç»‘å®šJSONåº”ç”¨æŒ‰é’®äº‹ä»¶
  const applyJsonBtn = document.getElementById('applyJsonBtn');
  applyJsonBtn.onclick = () => {
    const jsonInput = document.getElementById('jsonInput');
    const newMap = parseCustomJson(jsonInput.value);
    
    if (newMap !== null) {
      // åˆå¹¶æ–°çš„è‡ªå®šä¹‰æ˜ å°„
      customServersMap = { ...customServersMap, ...newMap };
      
      // ä¿å­˜åˆ°localStorage
      try {
        localStorage.setItem('aa4_custom_servers', JSON.stringify(customServersMap));
      } catch (e) {
        console.log('æ— æ³•ä¿å­˜åˆ°localStorage:', e);
      }
      
      toast(`å·²åº”ç”¨ ${Object.keys(newMap).length} ä¸ªè‡ªå®šä¹‰åŒºæœ`);
      
      // åˆ·æ–°æ˜¾ç¤º
      const activeTab = document.querySelector('.tab.active');
      if (activeTab) {
        const gameId = games.find(g => g.name === activeTab.textContent)?.id;
        if (gameId) {
          renderContent(gameId);
        }
      }
    }
  };
  
  // ä»localStorageåŠ è½½è‡ªå®šä¹‰åŒºæœ
  try {
    const saved = localStorage.getItem('aa4_custom_servers');
    if (saved) {
      const parsed = JSON.parse(saved);
      if (parsed && typeof parsed === 'object') {
        customServersMap = parsed;
        console.log('å·²åŠ è½½è‡ªå®šä¹‰åŒºæœ:', customServersMap);
      }
    }
  } catch (e) {
    console.log('æ— æ³•ä»localStorageåŠ è½½:', e);
  }
  
  // æ·»åŠ é¡µé¢å¯è§æ€§æ£€æµ‹ï¼Œå½“é¡µé¢é‡æ–°å¯è§æ—¶åˆ·æ–°
  document.addEventListener('visibilitychange', function() {
    if (!document.hidden) {
      const activeTab = document.querySelector('.tab.active');
      if (activeTab) {
        const gameId = games.find(g => g.name === activeTab.textContent)?.id;
        if (gameId === 'swcq' && currentPlatform === 'aa4') {
          // é¡µé¢é‡æ–°å¯è§æ—¶åˆ·æ–°AA4åŒºæœ
          renderContent('swcq');
        }
      }
    }
  });
}

// åˆå§‹åŒ–
init();
</script>
    <!-- Footer -->
  <div class="footer-wrapper">
    <footer id="footer-container">åŠ è½½ä¸­...</footer>
  </div>
  <script src="/load-footer.js"></script>
<!-- footer -->
</body>
</html>
