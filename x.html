<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>üéÆ</title>
  <link rel="stylesheet" href="/footer.css" />
  <style>
    body {
      font-family: sans-serif;
      padding: 20px;
      background: #f5f5f5;
    }
    .btn-group {
      margin-bottom: 15px;
    }
    .btn-group button {
      margin-right: 10px;
      padding: 8px 14px;
      font-size: 1rem;
      cursor: pointer;
      border: 1px solid #ccc;
      background-color: white;
      border-radius: 4px;
      transition: background-color 0.2s, color 0.2s;
    }
    .btn-group button.active {
      background-color: #337ab7;
      color: white;
      border-color: #2a6496;
    }
    .btn-group button:hover:not(.active) {
      background-color: #e6e6e6;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      background: white;
      margin-top: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      table-layout: fixed;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 10px 8px;
      text-align: center;
      word-wrap: break-word;
    }
    th {
      background-color: #f0f0f0;
    }
    tbody tr:nth-child(even) {
      background-color: #fafafa;
    }
    a {
      color: #337ab7;
      text-decoration: none;
    }
    a:hover {
      text-decoration: underline;
    }
    #timeDisplay {
      margin: 10px 0;
      font-weight: bold;
    }
  </style>
</head>
<body>

  <div>
    <div><strong>ÈÄâÊã©Ê∏∏ÊàèÂå∫ÊúçÔºö</strong></div>
    <div id="combinedButtons" class="btn-group"></div>
  </div>

  <div id="timeDisplay"></div>

  <table id="linkTable">
    <thead>
      <tr>
        <th>Ê∏∏ÊàèÂπ≥Âè∞</th>
        <th>Â§áÊ≥®</th>
        <th>ÁôªÂΩïÂå∫ÊúçÈìæÊé•</th>
        <th>Ê∏∏Êàè‰∏ªÈ°µ</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

<script>
  // Ê∏∏ÊàèID -> Ê∏∏ÊàèÂêçÊò†Â∞Ñ
  const gameNames = {
    "115": "ÊÇ†‰πÖ‰º†Â•á",
    "111": "ÂàáÂâ≤Á•ûÂüü"
  };

  // Âπ≥Âè∞Êï∞ÊçÆ
  const platformData = [
    { name: "336buy", base: "http://gm.336buy.com", remark: "qqq", servers: [
      { gameId: "115", serverId: "1", openTime: "2025-10-07" },
      { gameId: "115", serverId: "2", openTime: "2025-10-08" },
      { gameId: "115", serverId: "120" },
      { gameId: "111", serverId: "277", openTime: "2025-09-10" }
    ]},
    { name: "395wan", base: "http://game.395wan.com", remark: "qqq", servers: [
      { gameId: "115", serverId: "1", openTime: "2025-10-07" },
      { gameId: "115", serverId: "2", openTime: "2025-10-08" },
      { gameId: "115", serverId: "120" },
      { gameId: "111", serverId: "277", openTime: "2025-09-10" }
    ]},
    { name: "lovedfm", base: "http://mv.lovedfm.com", remark: "qqq", servers: [
      { gameId: "115", serverId: "1", openTime: "2025-10-07" },
      { gameId: "115", serverId: "2", openTime: "2025-10-08" },
      { gameId: "115", serverId: "120" },
      { gameId: "111", serverId: "277", openTime: "2025-09-10" }
    ]},
    { name: "99yn", base: "http://gm.99yn.cn", remark: "qqq", servers: [
      { gameId: "115", serverId: "1", openTime: "2025-10-07" },
      { gameId: "115", serverId: "2", openTime: "2025-10-08" },
      { gameId: "115", serverId: "120" },
      { gameId: "111", serverId: "277", openTime: "2025-09-10" }
    ]},
    { name: "32sf", base: "http://mv.32sf.cn", remark: "q0-1", servers: [
      { gameId: "115", serverId: "1", openTime: "2025-10-07" },
      { gameId: "115", serverId: "2", openTime: "2025-10-08" },
      { gameId: "115", serverId: "120" },
      { gameId: "111", serverId: "277", openTime: "2025-09-10" }
    ]},
    { name: "395wan", base: "http://game.395wan.com", remark: "aaa", servers: [
      { gameId: "115", serverId: "120"},
      { gameId: "111", serverId: "277", openTime: "2025-09-10" }
    ]},
    { name: "42uc", base: "http://gm.42uc.com", remark: "a0-2", servers: [
      { gameId: "115", serverId: "120" },
      { gameId: "111", serverId: "277", openTime: "2025-09-10" }
    ]},
    { name: "8kyou", base: "http://www.8kyou.com:81", remark: "a1-9", servers: [
      { gameId: "115", serverId: "120"},
      { gameId: "111", serverId: "277", openTime: "2025-09-10" }
    ]},
    { name: "xayxms", base: "http://gm.yx4f.com:81", remark: "xxxx", servers: [
      { gameId: "115", serverId: "120" },
      { gameId: "111", serverId: "277" }
    ]}
  ];

  const combinedButtons = document.getElementById('combinedButtons');
  const tbody = document.querySelector('#linkTable tbody');
  const timeDisplay = document.getElementById('timeDisplay');

  let selectedGameId = null;
  let selectedServerId = null;

  function getBeijingTime() {
    const now = new Date();
    const utc = now.getTime() + now.getTimezoneOffset() * 60000;
    return new Date(utc + 8 * 3600000);
  }

  function numberToCircle(num) {
    const circles = ["‚ë†","‚ë°","‚ë¢","‚ë£","‚ë§","‚ë•","‚ë¶","‚ëß","‚ë®","‚ë©"];
    return circles[num - 1] || num;
  }

  function updateTimeDisplay() {
    const bjTime = getBeijingTime();
    timeDisplay.textContent = "Âåó‰∫¨Êó∂Èó¥Ôºö" + bjTime.toLocaleString('zh-CN', {
      year: 'numeric', month: '2-digit', day: '2-digit',
      hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false
    });
    renderTable();
  }

  function renderCombinedButtons() {
    combinedButtons.innerHTML = '';
    const seen = new Set();

    platformData.forEach(pf => {
      pf.servers.forEach(sv => {
        const key = `${sv.gameId}-${sv.serverId}`;
        if (seen.has(key)) return;
        seen.add(key);

        const btn = document.createElement('button');
        btn.textContent = `${gameNames[sv.gameId]}${sv.serverId}Êúç`;
        btn.addEventListener('click', () => {
          selectedGameId = sv.gameId;
          selectedServerId = sv.serverId;
          renderTable();
          [...combinedButtons.children].forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
        });
        combinedButtons.appendChild(btn);
      });
    });
  }

  function renderTable() {
    if (!selectedGameId || !selectedServerId) return;
    tbody.innerHTML = '';

    const bjTime = getBeijingTime();
    let index = 1;

    // ‚úÖ Êåâ remark È¶ñÂ≠óÊØçÊéíÂ∫è
    const sortedPlatforms = [...platformData].sort((a, b) => {
      const ra = (a.remark || '').trim().charAt(0).toLowerCase();
      const rb = (b.remark || '').trim().charAt(0).toLowerCase();
      if (ra < rb) return -1;
      if (ra > rb) return 1;
      return 0;
    });

    sortedPlatforms.forEach(pf => {
      pf.servers.forEach(sv => {
        if (sv.gameId !== selectedGameId || sv.serverId !== selectedServerId) return;

        let remarkType = "";
        if (pf.remark) {
          const firstChar = pf.remark.trim().charAt(0).toLowerCase();
          if (firstChar === "q") remarkType = " (QÁ±ª)";
          else if (firstChar === "a") remarkType = " (AÁ±ª)";
        }

        const loginUrl = `${pf.base}/login/${sv.gameId}/${sv.serverId}.html`;
        const homeUrl = `${pf.base}/games/${sv.gameId}.html`;

        let extra = "";
        if (sv.openTime) {
          const openTime = new Date(sv.openTime);
          const openDate = new Date(openTime.getFullYear(), openTime.getMonth(), openTime.getDate());
          const bjDate = new Date(bjTime.getFullYear(), bjTime.getMonth(), bjTime.getDate());
          const diffDays = Math.floor((bjDate - openDate) / (1000 * 60 * 60 * 24));

          if (diffDays < 0) extra = " ‚è≥ Êú™ÂºÄÊúç";
          else if (diffDays === 0) extra = " üöÄ ‰ªäÊó•ÂºÄÊúç";
          else if (diffDays === 1) extra = " üéâ Êò®Êó•ÂºÄÊúç";
          else if (diffDays >= 2) extra = " üîö Â∑≤ËøáÊúü";
        }

        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${pf.name}${remarkType}</td>
          <td>${pf.remark}</td>
          <td><a href="${loginUrl}" target="_blank">${numberToCircle(index)} ${gameNames[sv.gameId]}${sv.serverId}Êúç${extra}</a></td>
          <td><a href="${homeUrl}" target="_blank">‰∏ªÈ°µ</a></td>
        `;
        tbody.appendChild(row);
        index++;
      });
    });
  }

  function init() {
    renderCombinedButtons();
    const first = platformData[0].servers[0];
    selectedGameId = first.gameId;
    selectedServerId = first.serverId;
    renderTable();
    document.querySelector('#combinedButtons button')?.classList.add('active');

    updateTimeDisplay();
    setInterval(updateTimeDisplay, 1000);
  }

  init();
</script>

<div class="footer-wrapper">
  <footer id="footer-container">Âä†ËΩΩ‰∏≠...</footer>
</div>
<script src="/load-footer.js"></script>

</body>
</html>
