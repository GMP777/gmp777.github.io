<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ğŸ—“</title>
  <link rel="stylesheet" href="/footer.css" />
  <style>
    body {
      font-family: sans-serif;
      padding: 20px;
      background: #f5f5f5;
    }
    h2 {
      text-align: center;
    }
    .button-group-wrapper {
      margin-bottom: 20px;
    }
    .group-title {
      font-weight: bold;
      margin: 10px 0 5px;
    }
    .button-group {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 10px;
    }
    .button-group button {
      padding: 8px 14px;
      font-size: 14px;
      cursor: pointer;
      background: #fff;
      border: 1px solid #888;
      border-radius: 5px;
    }
    .button-group button.active {
      background: #337ab7;
      color: #fff;
      border-color: #337ab7;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      background: white;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    th, td {
      border: 1px solid #ccc;
      padding: 8px 10px;
      text-align: center;
    }
    th {
      background-color: #f0f0f0;
    }
    .day3 {
      background-color: #d1ffd1;
    }
    @media (max-width: 600px) {
      .button-group {
        flex-direction: column;
      }
      table, th, td {
        font-size: 0.9rem;
      }
    }
    a {
      color: #337ab7;
      text-decoration: none;
    }
    a:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <div class="button-group-wrapper" id="buttonGroups"></div>

  <table id="accountTable">
    <thead>
      <tr>
        <th>å¹³å°</th>
        <th>å¤‡æ³¨</th>
        <th>åˆ›å»ºæ—¥æœŸ</th>
        <th>ç¬¬å‡ å¤©</th>
        <th>ç¬¬3å¤©</th>
        <th>æ¸¸æˆé“¾æ¥</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    const serverGroups = {
      "115": ["112", "113", "114"],
      "111": ["265","264"]
    };

    const gameConfigs = [];
    Object.entries(serverGroups).forEach(([gameId, servers]) => {
      servers.forEach(server => gameConfigs.push({ gameId, server }));
    });

    const accounts = [
      {
        name: "xayxms",
        base: "http://gm.xayxms.cn",
        account: "xxxx",
        createDates: {
          "112": "2025-07-29",
          "113": "2025-07-11",
          "114": "2025-07-11",
          "265": "2025-07-30"
        }
      },
      {
        name: "395wan",
        base: "http://game.395wan.com",
        account: "qqq,aaa",
        createDates: {
          "112": "2025-07-30",
          "113": "2025-07-11",
          "114": "2025-07-11",
          "265": "2025-07-30"
        }
      },
      {
        name: "99yn",
        base: "http://gm.99yn.cn",
        account: "qqq",
        createDates: {
          "112": "2025-07-11",
          "113": "2025-07-11",
          "114": "2025-07-11",
          "265": "2025-07-11"
        }
      },
      {
        name: "8kyou",
        base: "http://www.8kyou.com:81",
        account: "qqq",
        createDates: {
          "112": "2025-07-11",
          "113": "2025-07-11",
          "114": "2025-07-11",
          "265": "2025-07-11"
        }
      },
      {
        name: "336buy",
        base: "http://gm.336buy.com",
        account: "æ— ",
        createDates: {
          "112": "2025-07-11",
          "113": "2025-07-11",
          "114": "2025-07-11",
          "265": "2025-07-11"
        }
      }
    ];

    let currentGame = gameConfigs[0];

    function createGroupedButtons() {
      const container = document.getElementById('buttonGroups');
      container.innerHTML = '';

      const grouped = {};
      gameConfigs.forEach(cfg => {
        if (!grouped[cfg.gameId]) grouped[cfg.gameId] = [];
        grouped[cfg.gameId].push(cfg);
      });

      Object.keys(grouped).forEach(gameId => {
        const title = document.createElement('div');
        title.className = 'group-title';
        title.textContent = 'æ¸¸æˆ ' + gameId;
        container.appendChild(title);

        const groupDiv = document.createElement('div');
        groupDiv.className = 'button-group';

        grouped[gameId].forEach(cfg => {
          const btn = document.createElement('button');
          btn.textContent = `${cfg.gameId}-${cfg.server}`;
          btn.onclick = () => {
            currentGame = cfg;
            document.querySelectorAll('.button-group button').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            renderTable();
          };
          if (cfg === currentGame) btn.classList.add('active');
          groupDiv.appendChild(btn);
        });

        container.appendChild(groupDiv);
      });
    }

    function getUTC8DateOnly(dateStr) {
      const [year, month, day] = dateStr.split('-').map(Number);
      return new Date(Date.UTC(year, month - 1, day, -8, 0, 0));
    }

    function getTodayUTC8DateOnly() {
      const now = new Date();
      const utc8 = new Date(now.getTime() + (8 * 60 * 60 * 1000));
      const year = utc8.getUTCFullYear();
      const month = utc8.getUTCMonth();
      const day = utc8.getUTCDate();
      return new Date(Date.UTC(year, month, day, -8, 0, 0));
    }

    function renderTable() {
      const { gameId, server } = currentGame;
      const today = getTodayUTC8DateOnly();
      const tbody = document.querySelector('#accountTable tbody');
      tbody.innerHTML = '';

      let hasData = false;

      accounts.forEach(acc => {
        const createDateStr = acc.createDates[server];
        if (!createDateStr) return;

        const createDate = getUTC8DateOnly(createDateStr);
        const days = Math.floor((today - createDate) / (1000 * 60 * 60 * 24)) + 1;
        const isDay3 = days === 3;
        const gameUrl = `${acc.base}/login/${gameId}/${server}.html`;

        const row = document.createElement('tr');
        if (isDay3) row.classList.add('day3');

        row.innerHTML = `
          <td>${acc.name}</td>
          <td>${acc.account}</td>
          <td>${createDateStr}</td>
          <td>ç¬¬ ${days} å¤©</td>
          <td>${isDay3 ? 'âœ… æ˜¯' : 'âŒ å¦'}</td>
          <td><a href="${gameUrl}" target="_blank">è¿›å…¥æ¸¸æˆ</a></td>
        `;

        tbody.appendChild(row);
        hasData = true;
      });

      if (!hasData) {
        const row = document.createElement('tr');
        row.innerHTML = `<td colspan="6">æ— è´¦å·æ•°æ®</td>`;
        tbody.appendChild(row);
      }
    }

    createGroupedButtons();
    renderTable();
  </script>

  <div class="footer-wrapper">
    <footer id="footer-container">åŠ è½½ä¸­...</footer>
  </div>
  <script src="/load-footer.js"></script>
</body>
</html>
